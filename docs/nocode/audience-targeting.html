<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Audience Targeting | SalesTim | Tech Hub</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/favicon.ico">
    <link rel="stylesheet" href="/css/bundle.css">
    <script src="https://www.googletagmanager.com/gtag/js?id=UA-5688830-15"></script>
    <script type="text/javascript" src="/js/bundle.js"></script>
    <meta name="description" content="SalesTim documentation for Citizen Developers, Developers and IT Pros">
    <meta name="twitter:title" content="Audience Targeting">
    <meta name="twitter:description" content="">
    <meta name="twitter:card" content="summary">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Audience Targeting">
    <meta property="og:description" content="">
    <meta itemprop="name" content="Audience Targeting">
    <meta itemprop="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.0b85ea1d.css" as="style"><link rel="preload" href="/assets/js/app.17377947.js" as="script"><link rel="preload" href="/assets/js/4.a6d52726.js" as="script"><link rel="preload" href="/assets/js/103.c27bf257.js" as="script"><link rel="preload" href="/assets/js/17.b34ec40f.js" as="script"><link rel="prefetch" href="/assets/js/1.f7533cbe.js"><link rel="prefetch" href="/assets/js/10.68738bd3.js"><link rel="prefetch" href="/assets/js/100.9fe1d2a2.js"><link rel="prefetch" href="/assets/js/101.052fd99b.js"><link rel="prefetch" href="/assets/js/102.bccca621.js"><link rel="prefetch" href="/assets/js/104.8244a3fe.js"><link rel="prefetch" href="/assets/js/105.7072e436.js"><link rel="prefetch" href="/assets/js/106.03d0424a.js"><link rel="prefetch" href="/assets/js/107.c55701b3.js"><link rel="prefetch" href="/assets/js/108.cd3af489.js"><link rel="prefetch" href="/assets/js/109.bcd280c5.js"><link rel="prefetch" href="/assets/js/11.c7e629e5.js"><link rel="prefetch" href="/assets/js/110.11c6ac04.js"><link rel="prefetch" href="/assets/js/111.ae93f561.js"><link rel="prefetch" href="/assets/js/112.6961ee4d.js"><link rel="prefetch" href="/assets/js/113.85a2089f.js"><link rel="prefetch" href="/assets/js/114.22c9f77e.js"><link rel="prefetch" href="/assets/js/115.ab34331b.js"><link rel="prefetch" href="/assets/js/116.7de7aab8.js"><link rel="prefetch" href="/assets/js/117.2982d9a7.js"><link rel="prefetch" href="/assets/js/118.a007e307.js"><link rel="prefetch" href="/assets/js/119.57639074.js"><link rel="prefetch" href="/assets/js/12.911d4355.js"><link rel="prefetch" href="/assets/js/120.c58b0c75.js"><link rel="prefetch" href="/assets/js/121.24a423ca.js"><link rel="prefetch" href="/assets/js/122.45d319f8.js"><link rel="prefetch" href="/assets/js/13.43506681.js"><link rel="prefetch" href="/assets/js/14.1d17bea6.js"><link rel="prefetch" href="/assets/js/15.7f3727e5.js"><link rel="prefetch" href="/assets/js/16.02e4996d.js"><link rel="prefetch" href="/assets/js/18.5ca2b808.js"><link rel="prefetch" href="/assets/js/19.a55e6266.js"><link rel="prefetch" href="/assets/js/20.cfcdcf45.js"><link rel="prefetch" href="/assets/js/21.f9eb738a.js"><link rel="prefetch" href="/assets/js/22.8879ec6a.js"><link rel="prefetch" href="/assets/js/23.c4900b32.js"><link rel="prefetch" href="/assets/js/24.26384a35.js"><link rel="prefetch" href="/assets/js/25.62d838aa.js"><link rel="prefetch" href="/assets/js/26.c1d17413.js"><link rel="prefetch" href="/assets/js/27.9c034bda.js"><link rel="prefetch" href="/assets/js/28.5df25e43.js"><link rel="prefetch" href="/assets/js/29.4b75e656.js"><link rel="prefetch" href="/assets/js/30.e0553a66.js"><link rel="prefetch" href="/assets/js/31.77001cf8.js"><link rel="prefetch" href="/assets/js/32.3001bbc1.js"><link rel="prefetch" href="/assets/js/33.4ec798e1.js"><link rel="prefetch" href="/assets/js/34.096be16e.js"><link rel="prefetch" href="/assets/js/35.8bf6dc4d.js"><link rel="prefetch" href="/assets/js/36.7c75698c.js"><link rel="prefetch" href="/assets/js/37.f00f508a.js"><link rel="prefetch" href="/assets/js/38.0756b547.js"><link rel="prefetch" href="/assets/js/39.db6fe206.js"><link rel="prefetch" href="/assets/js/40.bd1996e7.js"><link rel="prefetch" href="/assets/js/41.87447d4c.js"><link rel="prefetch" href="/assets/js/42.8a92c268.js"><link rel="prefetch" href="/assets/js/43.e83395e5.js"><link rel="prefetch" href="/assets/js/44.62784ba1.js"><link rel="prefetch" href="/assets/js/45.e22fc344.js"><link rel="prefetch" href="/assets/js/46.a97eb894.js"><link rel="prefetch" href="/assets/js/47.075764c2.js"><link rel="prefetch" href="/assets/js/48.2a705730.js"><link rel="prefetch" href="/assets/js/49.dc9ad925.js"><link rel="prefetch" href="/assets/js/5.fbb001ee.js"><link rel="prefetch" href="/assets/js/50.25c06422.js"><link rel="prefetch" href="/assets/js/51.995ab845.js"><link rel="prefetch" href="/assets/js/52.0818b180.js"><link rel="prefetch" href="/assets/js/53.ff603894.js"><link rel="prefetch" href="/assets/js/54.2f4cfcee.js"><link rel="prefetch" href="/assets/js/55.a320b4e2.js"><link rel="prefetch" href="/assets/js/56.c4231161.js"><link rel="prefetch" href="/assets/js/57.b7bcdcce.js"><link rel="prefetch" href="/assets/js/58.8f7e8259.js"><link rel="prefetch" href="/assets/js/59.aa1b1703.js"><link rel="prefetch" href="/assets/js/6.3e6d3857.js"><link rel="prefetch" href="/assets/js/60.fbd37b10.js"><link rel="prefetch" href="/assets/js/61.39ac8d18.js"><link rel="prefetch" href="/assets/js/62.ed9b5171.js"><link rel="prefetch" href="/assets/js/63.1dce32e5.js"><link rel="prefetch" href="/assets/js/64.33c5576c.js"><link rel="prefetch" href="/assets/js/65.377d153b.js"><link rel="prefetch" href="/assets/js/66.fcee93e1.js"><link rel="prefetch" href="/assets/js/67.c07b8373.js"><link rel="prefetch" href="/assets/js/68.cbb91e74.js"><link rel="prefetch" href="/assets/js/69.29521406.js"><link rel="prefetch" href="/assets/js/7.d6a9a079.js"><link rel="prefetch" href="/assets/js/70.1a811782.js"><link rel="prefetch" href="/assets/js/71.1e41e36b.js"><link rel="prefetch" href="/assets/js/72.1b6ad5c6.js"><link rel="prefetch" href="/assets/js/73.853514c9.js"><link rel="prefetch" href="/assets/js/74.b3654cb7.js"><link rel="prefetch" href="/assets/js/75.1c41ac54.js"><link rel="prefetch" href="/assets/js/76.db5b8a45.js"><link rel="prefetch" href="/assets/js/77.fc8b7914.js"><link rel="prefetch" href="/assets/js/78.826bc290.js"><link rel="prefetch" href="/assets/js/79.387536c2.js"><link rel="prefetch" href="/assets/js/8.f958ec46.js"><link rel="prefetch" href="/assets/js/80.40949883.js"><link rel="prefetch" href="/assets/js/81.3085819b.js"><link rel="prefetch" href="/assets/js/82.030034ab.js"><link rel="prefetch" href="/assets/js/83.cdd8f9fd.js"><link rel="prefetch" href="/assets/js/84.0c6a6db3.js"><link rel="prefetch" href="/assets/js/85.700ed32d.js"><link rel="prefetch" href="/assets/js/86.f5947c69.js"><link rel="prefetch" href="/assets/js/87.a43ca040.js"><link rel="prefetch" href="/assets/js/88.78efc27a.js"><link rel="prefetch" href="/assets/js/89.a721ca17.js"><link rel="prefetch" href="/assets/js/9.ddcd7b32.js"><link rel="prefetch" href="/assets/js/90.e9fe9cc1.js"><link rel="prefetch" href="/assets/js/91.d29bb906.js"><link rel="prefetch" href="/assets/js/92.b02a850d.js"><link rel="prefetch" href="/assets/js/93.e98a29f1.js"><link rel="prefetch" href="/assets/js/94.9554fcf3.js"><link rel="prefetch" href="/assets/js/95.631e8a07.js"><link rel="prefetch" href="/assets/js/96.9428ce54.js"><link rel="prefetch" href="/assets/js/97.793c2528.js"><link rel="prefetch" href="/assets/js/98.9d84314d.js"><link rel="prefetch" href="/assets/js/99.cedb854e.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.fe1d5732.js">
    <link rel="stylesheet" href="/assets/css/0.styles.0b85ea1d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/color.png" alt="SalesTim | Tech Hub" class="logo"> <span class="site-name can-hide">SalesTim | Tech Hub</span></a> <div class="links"><!----> <div class="user-settings"><a href="#" class="settings-button"><svg aria-hidden="true" data-prefix="fas" data-icon="cog" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="svg-inline--fa fa-cog fa-w-16 settings-icon"><path fill="currentColor" d="M444.788 291.1l42.616 24.599c4.867 2.809 7.126 8.618 5.459 13.985-11.07 35.642-29.97 67.842-54.689 94.586a12.016 12.016 0 0 1-14.832 2.254l-42.584-24.595a191.577 191.577 0 0 1-60.759 35.13v49.182a12.01 12.01 0 0 1-9.377 11.718c-34.956 7.85-72.499 8.256-109.219.007-5.49-1.233-9.403-6.096-9.403-11.723v-49.184a191.555 191.555 0 0 1-60.759-35.13l-42.584 24.595a12.016 12.016 0 0 1-14.832-2.254c-24.718-26.744-43.619-58.944-54.689-94.586-1.667-5.366.592-11.175 5.459-13.985L67.212 291.1a193.48 193.48 0 0 1 0-70.199l-42.616-24.599c-4.867-2.809-7.126-8.618-5.459-13.985 11.07-35.642 29.97-67.842 54.689-94.586a12.016 12.016 0 0 1 14.832-2.254l42.584 24.595a191.577 191.577 0 0 1 60.759-35.13V25.759a12.01 12.01 0 0 1 9.377-11.718c34.956-7.85 72.499-8.256 109.219-.007 5.49 1.233 9.403 6.096 9.403 11.723v49.184a191.555 191.555 0 0 1 60.759 35.13l42.584-24.595a12.016 12.016 0 0 1 14.832 2.254c24.718 26.744 43.619 58.944 54.689 94.586 1.667 5.366-.592 11.175-5.459 13.985L444.788 220.9a193.485 193.485 0 0 1 0 70.2zM336 256c0-44.112-35.888-80-80-80s-80 35.888-80 80 35.888 80 80 80 80-35.888 80-80z"></path></svg></a> <div class="user-settings-menu" style="display:none;"><div class="theme-options"><!----> <ul class="color-theme-options"><li><a href="#" class="default-theme"></a></li> <li><a href="#" class="blue-theme"></a></li><li><a href="#" class="red-theme"></a></li><li><a href="#" class="purple-theme"></a></li></ul> <div class="dark-theme-options toggle-option"><label for="dark-theme-toggle">üåó Dark Theme</label> <input id="dark-theme-toggle" type="checkbox"></div> <div class="ignore-themes-options toggle-option"><label for="ignore-themes-toggle">Ignore Other Themes?</label> <input id="ignore-themes-toggle" type="checkbox"></div> <!----></div></div></div> <!----> <form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/nocode/" class="nav-link router-link-active">
  No-Code
</a></div><div class="nav-item"><a href="/api/" class="nav-link">
  API &amp; Webhooks
</a></div><div class="nav-item"><a href="/api/explorer.html" class="nav-link">
  Explorer
</a></div><div class="nav-item"><a href="/platform/" class="nav-link">
  Trust Center
</a></div><div class="nav-item"><a href="/blog/" class="nav-link">
  Inside SalesTim
</a></div> <a href="https://github.com/salestim" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/nocode/" class="nav-link router-link-active">
  No-Code
</a></div><div class="nav-item"><a href="/api/" class="nav-link">
  API &amp; Webhooks
</a></div><div class="nav-item"><a href="/api/explorer.html" class="nav-link">
  Explorer
</a></div><div class="nav-item"><a href="/platform/" class="nav-link">
  Trust Center
</a></div><div class="nav-item"><a href="/blog/" class="nav-link">
  Inside SalesTim
</a></div> <a href="https://github.com/salestim" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>No-Code Solutions</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/nocode/" aria-current="page" class="sidebar-link">Get Started</a></li><li><a href="/nocode/naming-conventions.html" class="sidebar-link">Naming conventions</a></li><li><a href="/nocode/approval.html" class="sidebar-link">Approval workflow</a></li><li><a href="/nocode/audience-targeting.html" aria-current="page" class="active sidebar-link">Audience Targeting</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/nocode/audience-targeting.html#abstract" class="sidebar-link">Abstract</a></li><li class="sidebar-sub-header"><a href="/nocode/audience-targeting.html#available-tags" class="sidebar-link">Available tags</a></li><li class="sidebar-sub-header"><a href="/nocode/audience-targeting.html#examples" class="sidebar-link">Examples</a></li><li class="sidebar-sub-header"><a href="/nocode/audience-targeting.html#validate-and-test-your-audience-targeting-rule" class="sidebar-link">Validate and test your audience targeting rule</a></li></ul></li><li><a href="/nocode/power-platform.html" class="sidebar-link">Power Platform</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>API &amp; Webhooks</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Trust Center</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="audience-targeting"><a href="#audience-targeting" class="header-anchor">#</a> Audience Targeting</h1> <div data-v-41c95b0e><div data-v-41c95b0e><a href="/platform/classification.html" data-v-41c95b0e><img alt="classification:PUBLIC" src="https://img.shields.io/badge/classification-PUBLIC-red" data-v-41c95b0e></a></div></div> <h2 id="abstract"><a href="#abstract" class="header-anchor">#</a> Abstract</h2> <p>An audience targeting rule could be applied to a template to define who can access and therefore use it, based on the user profile data. Intrinsically, targeting rules are a combination of tags and expressions that are evaluated against a user profile to determine if a template is shown or not.</p> <p><strong>Table of Contents</strong>:
</p><div class="table-of-contents"><ul><li><a href="#abstract">Abstract</a></li><li><a href="#available-tags">Available tags</a></li><li><a href="#examples">Examples</a><ul><li><a href="#comparison-operators">Comparison operators</a></li><li><a href="#combining-multiple-criteria">Combining multiple criteria</a></li><li><a href="#functions">Functions</a></li><li><a href="#using-groups-membership">Using groups membership</a></li></ul></li><li><a href="#validate-and-test-your-audience-targeting-rule">Validate and test your audience targeting rule</a></li></ul></div><p></p> <h2 id="available-tags"><a href="#available-tags" class="header-anchor">#</a> Available tags</h2> <p>Targeting rules can use user profile information through the following tags:</p> <table><thead><tr><th>Tag</th> <th>Description</th></tr></thead> <tbody><tr><td><code>user.displayName</code></td> <td>User full name (for example &quot;Bob Dirac&quot;.)</td></tr> <tr><td><code>user.userPrincipalName</code></td> <td>User UPN. In Active Directory, a User Principal Name (UPN) is the name of a system user in an email address format. A UPN (for example: &quot;bob.dirac@contoso.onmicrosoft.com&quot;) consists of the user name (logon name), separator (the @ symbol), and domain name (UPN suffix). <hr>Important: A UPN is not the same as an email address. Sometimes, a UPN can match a user's email address, but this is not a general rule.</td></tr> <tr><td><code>user.mail</code></td> <td>User email (for example: &quot;bob.dirac@domain.com&quot;).</td></tr> <tr><td><code>user.preferredLanguage</code></td> <td>User preferred language in Microsoft 365. <hr>Language and locale codes are limited to those in the <a href="https://en.wikipedia.org/wiki/ISO_639-1" target="_blank" rel="noopener noreferrer">ISO 639-1 standard<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</td></tr> <tr><td><code>user.givenName</code></td> <td>User given name (for example: &quot;Bob&quot;).</td></tr> <tr><td><code>user.country</code></td> <td>User country (for example: &quot;France&quot;).</td></tr> <tr><td><code>user.companyName</code></td> <td>User company name (for example: &quot;Contoso&quot;).</td></tr> <tr><td><code>user.department</code></td> <td>User department (for example: &quot;Marketing&quot;).</td></tr> <tr><td><code>user.city</code></td> <td>User city (for example: &quot;Paris&quot;).</td></tr> <tr><td><code>user.jobTitle</code></td> <td>User job title (for example: &quot;Product Manager&quot;).</td></tr> <tr><td><code>user.surname</code></td> <td>User surname (for example: &quot;Dirac&quot;).</td></tr> <tr><td><code>user.usageLocation</code></td> <td>Office 365 usage location. (for example: &quot;US&quot;) <hr>Rely on the <a href="https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2" target="_blank" rel="noopener noreferrer">ISO 3166-1 alpha-2 country codes...<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</td></tr> <tr><td><code>user.groups.direct</code></td> <td>All the groups that the user is a DIRECT member of.</td></tr></tbody></table> <div class="custom-block warning"><p class="custom-block-title">Case sensitivity</p> <p>Be careful: These tags are <strong>CASE-SENSITIVE</strong> and therefore must be always used lower-cased.</p></div> <h2 id="examples"><a href="#examples" class="header-anchor">#</a> Examples</h2> <p>In combination with tags, targeting rules can use any standard JavaScript operator and function. This section provides some typical examples, from the simplest to the most complex one, to target your templates to specific audiences in an organization.</p> <h3 id="comparison-operators"><a href="#comparison-operators" class="header-anchor">#</a> Comparison operators</h3> <p>To compare two values, your expression can use any standard JavaScript <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Expressions_and_Operators#comparison_operators" target="_blank" rel="noopener noreferrer">comparison operator<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// From France</span>
user<span class="token punctuation">.</span>country <span class="token operator">===</span> <span class="token string">'FR'</span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// From any country except from Germany</span>
user<span class="token punctuation">.</span>country <span class="token operator">!==</span> <span class="token string">'DE'</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">Evaluation</p> <p>N.B: The template will be shown to a user only if the expression is evaluated as <code>true</code></p></div> <h3 id="combining-multiple-criteria"><a href="#combining-multiple-criteria" class="header-anchor">#</a> Combining multiple criteria</h3> <p>Rules follows the standard JavaScript <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Operator_Precedence" target="_blank" rel="noopener noreferrer">operator precedence<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, so you can combine multiple rules in one expression.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// From France or Belgium, member of the Marketing Department</span>
<span class="token punctuation">(</span> user<span class="token punctuation">.</span>country <span class="token operator">===</span> <span class="token string">'FR'</span> <span class="token operator">||</span> user<span class="token punctuation">.</span>country <span class="token operator">===</span> <span class="token string">'BE'</span> <span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> user<span class="token punctuation">.</span>department <span class="token operator">===</span> <span class="token string">'Marketing'</span> 
</code></pre></div><h3 id="functions"><a href="#functions" class="header-anchor">#</a> Functions</h3> <p>As part of your rules, you can use any standard JavaScript function, for instance <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String#instance_methods" target="_blank" rel="noopener noreferrer">strings methods<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, or for more advanced scenarios, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions" target="_blank" rel="noopener noreferrer">regular expressions<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// English speakers from any country</span>
user<span class="token punctuation">.</span>preferredLanguage<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">'en-'</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// users with @contoso.com or @contoso.fr in their email domain name</span>
user<span class="token punctuation">.</span>mail<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">'@contoso.com'</span><span class="token punctuation">)</span> <span class="token operator">||</span> user<span class="token punctuation">.</span>mail<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">'@contoso.fr'</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="using-groups-membership"><a href="#using-groups-membership" class="header-anchor">#</a> Using groups membership</h3> <p>The <code>user.groups.direct</code> tag gives you access to all the groups that the user is a DIRECT member of, as an array of groups objects. Therefore, you can use any standard JavaScript <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array#instance_methods" target="_blank" rel="noopener noreferrer">array function<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for your evaluation.</p> <p>There are several types of groups, that can be differentiated by their <code>@odata.type</code> property:</p> <div class="custom-block warning"><p class="custom-block-title">Note</p> <p>The response object shown here might be shortened for readability. All the default properties are returned for each group in an actual call.</p></div> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;@odata.type&quot;</span><span class="token operator">:</span><span class="token string">&quot;#microsoft.graph.directoryRole&quot;</span><span class="token punctuation">,</span> <span class="token comment">// Standard Azure AD groups, such as the admin roles from your Microsoft 365 environment</span>
    <span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;3b4b0f4e-d037-4116-bd0e-1a2173d95d5a&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;deletedDateTime&quot;</span><span class="token operator">:</span><span class="token null keyword">null</span><span class="token punctuation">,</span>
    <span class="token property">&quot;description&quot;</span><span class="token operator">:</span><span class="token string">&quot;Company Administrator role has full access to perform any operation in the company scope.&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;displayName&quot;</span><span class="token operator">:</span><span class="token string">&quot;Global Administrator&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;roleTemplateId&quot;</span><span class="token operator">:</span><span class="token string">&quot;72e90394-69f5-4237-9190-012177145e10&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;@odata.type&quot;</span><span class="token operator">:</span><span class="token string">&quot;#microsoft.graph.group&quot;</span><span class="token punctuation">,</span> <span class="token comment">// Microsoft 365 groups, associated with a team or a SharePoint site.</span>
    <span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;e9090752-4430-4361-8594-e6ce98a7fbfa&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;deletedDateTime&quot;</span><span class="token operator">:</span><span class="token null keyword">null</span><span class="token punctuation">,</span>
    <span class="token property">&quot;classification&quot;</span><span class="token operator">:</span><span class="token null keyword">null</span><span class="token punctuation">,</span>
    <span class="token property">&quot;createdDateTime&quot;</span><span class="token operator">:</span><span class="token string">&quot;2020-08-04T15:39:08Z&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;description&quot;</span><span class="token operator">:</span><span class="token string">&quot;A fantastic group!!!&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;displayName&quot;</span><span class="token operator">:</span><span class="token string">&quot;Onboarding&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;groupTypes&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&quot;Unified&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;mail&quot;</span><span class="token operator">:</span><span class="token string">&quot;Onboarding@contoso.com&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;mailEnabled&quot;</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">&quot;mailNickname&quot;</span><span class="token operator">:</span><span class="token string">&quot;Onboarding&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;preferredDataLocation&quot;</span><span class="token operator">:</span><span class="token null keyword">null</span><span class="token punctuation">,</span>
    <span class="token property">&quot;preferredLanguage&quot;</span><span class="token operator">:</span><span class="token null keyword">null</span><span class="token punctuation">,</span>
    <span class="token property">&quot;resourceProvisioningOptions&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&quot;Team&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;visibility&quot;</span><span class="token operator">:</span><span class="token string">&quot;Private&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>In this example, we're testing user membership by checking if one of its groups contains the word &quot;Onboarding&quot; in its display name:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Is a member of an &quot;Onboarding&quot; group</span>
user<span class="token punctuation">.</span>groups<span class="token punctuation">.</span>direct<span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span><span class="token parameter">group</span> <span class="token operator">=&gt;</span> group<span class="token punctuation">.</span>displayName<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">'Onboarding'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">Case sensitivity</p> <p>Be careful, evaluations are <strong>case-sensitive</strong>. Therefore to make sure your evaluation work independently of the case, you can use the <code>toLowerCase</code> function, such as: <code>group.displayName.toLowerCase().includes('Onboarding')</code></p></div> <p>In this example, we're testing is the user is a member of a specific group by checking if one of its groups has a specific ID:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Is a member of a specific group by its ID</span>
user<span class="token punctuation">.</span>groups<span class="token punctuation">.</span>direct<span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span><span class="token parameter">group</span> <span class="token operator">=&gt;</span> group<span class="token punctuation">.</span>id <span class="token operator">===</span> <span class="token punctuation">(</span><span class="token string">'a937979b-5dbb-4f54-a405-936046244b0b'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="validate-and-test-your-audience-targeting-rule"><a href="#validate-and-test-your-audience-targeting-rule" class="header-anchor">#</a> Validate and test your audience targeting rule</h2> <div class="custom-block tip"><p class="custom-block-title">Syntax Assistant</p> <p>A &quot;Check Syntax&quot; button is available to test the rule against the current logged user. You can expect 3 kind of outcomes.</p> <ol><li>You would have access</li> <li>You would not have access</li> <li>An error is detected. In case of error, the technical details are also available, helping you solve the issue.</li></ol></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/salestim/tech-hub/edit/master/src/app/nocode/audience-targeting.md" target="_blank" rel="noopener noreferrer">Improve this page!</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">2/19/2021, 2:53:13 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ‚Üê
      <a href="/nocode/approval.html" class="prev">
        Approval workflow
      </a></span> <span class="next"><a href="/nocode/power-platform.html">
        Power Platform
      </a>
      ‚Üí
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.17377947.js" defer></script><script src="/assets/js/4.a6d52726.js" defer></script><script src="/assets/js/103.c27bf257.js" defer></script><script src="/assets/js/17.b34ec40f.js" defer></script>
  </body>
</html>
